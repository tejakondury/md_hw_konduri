LAMMPS (17 Nov 2016)
# sample LAMMPS input script for diffusion of 2d LJ liquid
# mean-squared displacement via compute msd

# settings

variable	x equal 40
variable	y equal 40

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

lattice         sq2 ${rho}
lattice         sq2 0.6
Lattice spacing in x,y,z = 1.82574 1.82574 1.82574
region          simbox block 0 $x 0 $y -0.1 0.1
region          simbox block 0 40 0 $y -0.1 0.1
region          simbox block 0 40 0 40 -0.1 0.1
create_box      1 simbox
Created orthogonal box = (0 0 -0.182574) to (73.0297 73.0297 0.182574)
  5 by 1 by 1 MPI processor grid
create_atoms    1 box
Created 3200 atoms

pair_style      lj/cut ${rc}
pair_style      lj/cut 2.5
pair_coeff      * * 1 1

mass            * 1.0
velocity        all create $t 97287
velocity        all create 1 97287

fix             1 all nve
fix	        2 all langevin $t $t 0.1 498094
fix	        2 all langevin 1 $t 0.1 498094
fix	        2 all langevin 1 1 0.1 498094
fix	        3 all enforce2d

# equilibration run

thermo          1000
run	        5000
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.8
  ghost atom cutoff = 2.8
  binsize = 1.4 -> bins = 53 53 1
Memory usage per processor = 2.47943 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0            1     -1.56492            0   -0.5652325   -1.5346995 
    1000   0.97486224   -1.5736244            0  -0.59906685   0.97401858 
    2000   0.97718633   -1.5871699            0  -0.61028891   0.95402503 
    3000    1.0150086    -1.575617            0  -0.56092557    1.0254908 
    4000    1.0231666   -1.5771003            0  -0.55425344    1.0491885 
    5000   0.98269962   -1.5916993            0  -0.60930674   0.94598308 
Loop time of 1.79504 on 5 procs for 5000 steps with 3200 atoms

Performance: 1203313.702 tau/day, 2785.448 timesteps/s
89.6% CPU use with 5 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.38835    | 0.48048    | 0.8333     |  25.5 | 26.77
Neigh   | 0.11384    | 0.13325    | 0.20601    |  10.0 |  7.42
Comm    | 0.16419    | 0.42202    | 0.79475    |  45.1 | 23.51
Output  | 0.00015306 | 0.00019789 | 0.000247   |   0.2 |  0.01
Modify  | 0.21401    | 0.25423    | 0.4117     |  15.6 | 14.16
Other   |            | 0.5049     |            |       | 28.13

Nlocal:    640 ave 649 max 631 min
Histogram: 1 0 1 0 0 1 1 0 0 1
Nghost:    310.8 ave 323 max 292 min
Histogram: 1 0 0 0 0 1 0 1 1 1
Neighs:    4490.8 ave 4565 max 4372 min
Histogram: 1 0 0 0 1 0 1 0 0 2

Total # of neighbors = 22454
Ave neighs/atom = 7.01687
Neighbor list builds = 597
Dangerous builds = 0

unfix		2

# data gathering run

reset_timestep  0

compute         vacf all vacf
fix             4 all ave/time 1 1 1 c_vacf[4] #file tmp.vacf

# factor of 0.5 is for 2d

fix             5 all vector 1 c_vacf[4]
variable        vacf equal 0.5*dt*trap(f_5)

thermo_style	custom step temp c_vacf[4] v_vacf

# only need to run for 10K steps to make a good 100-frame movie

#dump	        1 all custom 1 tmp.dump id type vx vy vz

#dump		2 all image 100 image.*.jpg type type zoom 1.6 adiam 1.2

thermo          1000
run 100000
Memory usage per processor = 2.85443 Mbytes
Step Temp c_vacf[4] v_vacf 
       0   0.98269962     1.964785            0 
    1000   0.99092138 -0.014371851   0.23534806 
    2000   0.99848621 0.0024643418   0.25046235 
    3000   0.97309198  0.037872461   0.29389633 
    4000   0.97783061  0.014930787    0.3148827 
    5000   0.98231453 -0.028212141   0.32513337 
    6000   0.98161017  0.036043199   0.38873361 
    7000   0.99136927 -0.0058457799   0.36838948 
    8000   0.98359697  0.015208806   0.39623409 
    9000   0.99272715  0.027100694   0.43178632 
   10000   0.98592317 -0.0050507674   0.45541829 
   11000    1.0000627 -0.045890572    0.4450136 
   12000   0.98161267 -0.021080514   0.47923277 
   13000   0.99027593 -0.060343311   0.49523762 
   14000   0.99228612  0.036996071   0.50156362 
   15000   0.96927621 0.0053676523   0.49120138 
   16000    0.9802929  0.041552789    0.5115107 
   17000   0.98159313  -0.03066605   0.47169139 
   18000   0.99070671  0.015722618   0.47860589 
   19000    0.9684051 -0.050173391   0.47439554 
   20000   0.98746114 -0.0036889717   0.48405066 
   21000    0.9947463 -0.0046869808   0.47766815 
   22000   0.98065846 -0.00098795478   0.46277018 
   23000     0.978113 0.0095824048    0.4359056 
   24000   0.97483934 -0.0036985923   0.44812555 
   25000   0.99822468  0.025666764   0.46951486 
   26000   0.98985523 -0.023637939   0.47073773 
   27000    1.0040799  0.015128868   0.49188667 
   28000   0.99895473  0.014957731   0.50502772 
   29000   0.99348899 -0.015646616   0.52456198 
   30000    0.9716263 -0.034297017   0.51325486 
   31000    1.0050045 -0.029275887   0.49743074 
   32000    0.9833404 -0.0011740413   0.50559314 
   33000   0.97747849 -0.027193613   0.49794648 
   34000   0.99784913  0.038959564   0.51047817 
   35000   0.98006853  0.006945834   0.49474081 
   36000   0.99283964  0.053868194   0.51203327 
   37000   0.98373746 -0.00061491365   0.50196434 
   38000   0.98564481 -0.034822723   0.51128462 
   39000   0.98820959 -0.00093850042   0.50281094 
   40000   0.97590876 0.0047820939   0.50665788 
   41000   0.98474548 -0.0059896999   0.51080053 
   42000   0.99212242 -0.056763241   0.51498261 
   43000   0.97480526 -0.025935411   0.51217874 
   44000   0.99159545  0.016617505     0.546536 
   45000   0.99106261 -0.015518444    0.5605341 
   46000   0.99522981 -0.032967814   0.54440488 
   47000   0.98107071  0.028921339   0.53162871 
   48000    0.9756543 0.0099127333   0.53234498 
   49000   0.99038032 0.0080958894   0.55282095 
   50000    1.0033936 0.0026511173   0.54960942 
   51000   0.98092409 -0.014894142   0.56967795 
   52000   0.99635181 -0.018536947   0.58690514 
   53000    0.9838702 -0.010134154   0.58010282 
   54000   0.98318069 -0.020278708   0.56239268 
   55000   0.99544831 -0.032079755   0.54264939 
   56000   0.98828932 -0.030623075   0.53472285 
   57000   0.98477212  0.023898337     0.527568 
   58000    0.9874469 0.0047608007   0.53699712 
   59000   0.99641203  0.024290649   0.55313498 
   60000   0.97280404 -0.027967382   0.52875622 
   61000   0.98589545 -0.017595156   0.51401353 
   62000   0.98442872  -0.01888373   0.50467033 
   63000   0.98965017 0.0046432595   0.48425421 
   64000   0.97250211  0.011503201   0.48327264 
   65000    1.0025167 -0.014448625   0.48959193 
   66000   0.98757103 -0.026756943    0.4949783 
   67000   0.99008962  0.011361299   0.51460972 
   68000   0.97900853 0.0020405672   0.51213319 
   69000   0.98005821  0.042542213   0.53775158 
   70000   0.97799361 0.0098097661   0.53440989 
   71000   0.97812739 -0.00061807451   0.54767594 
   72000   0.98070265 -0.011015337   0.56244507 
   73000   0.98164828 -0.032329982   0.56228997 
   74000    0.9915932  0.013286439   0.57406832 
   75000   0.98564698  0.020434916    0.5851921 
   76000   0.97584943 -0.0030303593   0.58689212 
   77000   0.99081829 -0.0071134937   0.57794773 
   78000   0.98533986 -0.021788624   0.61249847 
   79000   0.96884258  0.016447106   0.62492031 
   80000   0.96918063 0.00069759833   0.59264199 
   81000   0.98743098  -0.04224572   0.60629671 
   82000     0.995994 -0.013124509    0.6057143 
   83000   0.97895876 0.0039233381     0.642362 
   84000   0.98493529  0.021833452   0.67289996 
   85000   0.98614581 0.0066598113   0.69598617 
   86000   0.99340776  0.039194067   0.70028027 
   87000   0.99450802 -0.017060103   0.71273891 
   88000   0.99419977  0.033871173   0.70384318 
   89000   0.98854684 -0.0048616852    0.6902297 
   90000   0.97206854 -0.016819196   0.68819635 
   91000   0.98409221 -0.015007574   0.67211097 
   92000   0.99246288 -0.029129771   0.66516571 
   93000   0.98624363  0.027585701   0.67619995 
   94000   0.98900408 -0.013916251   0.68068473 
   95000   0.99223972 0.0070341166    0.6550357 
   96000   0.98042633 -0.022314261   0.62803506 
   97000   0.98582505 -0.060199394   0.61196244 
   98000   0.99023095 0.0088398689   0.59673178 
   99000    1.0024172 -0.0038103913    0.5917527 
  100000   0.97848474   -0.0167361    0.5750552 
Loop time of 31.78 on 5 procs for 100000 steps with 3200 atoms

Performance: 1359344.037 tau/day, 3146.630 timesteps/s
89.7% CPU use with 5 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.6713     | 9.2885     | 15.394     | 100.2 | 29.23
Neigh   | 2.4148     | 2.9601     | 5.0033     |  59.4 |  9.31
Comm    | 3.3799     | 7.9118     | 14.849     | 188.8 | 24.90
Output  | 0.024629   | 0.030153   | 0.051384   |   6.1 |  0.09
Modify  | 4.9845     | 9.8268     | 16.349     | 166.9 | 30.92
Other   |            | 1.763      |            |       |  5.55

Nlocal:    640 ave 654 max 627 min
Histogram: 1 0 0 1 1 1 0 0 0 1
Nghost:    312.6 ave 321 max 302 min
Histogram: 1 1 0 0 0 0 0 1 0 2
Neighs:    4489.2 ave 4670 max 4347 min
Histogram: 1 1 0 0 1 0 1 0 0 1

Total # of neighbors = 22446
Ave neighs/atom = 7.01438
Neighbor list builds = 12769
Dangerous builds = 0
Total wall time: 0:00:34
0   0.98042633     684.6397   0.35658317   0.35103231 
   97000   0.98582505    691.11888   0.35624685   0.35113932 
   98000   0.99023095    700.48351   0.35738954   0.35125546 
   99000    1.0024172    706.92649   0.35703358   0.35137184 
  100000   0.97848474    715.40404   0.35770202   0.35149102 
Loop time of 27.3505 on 5 procs for 100000 steps with 3200 atoms

Performance: 1579498.541 tau/day, 3656.247 timesteps/s
99.8% CPU use with 5 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.753     | 14.884     | 14.979     |   2.3 | 54.42
Neigh   | 4.6422     | 4.6906     | 4.7477     |   2.0 | 17.15
Comm    | 3.5687     | 3.8193     | 4.0464     |   8.0 | 13.96
Output  | 0.013474   | 0.014014   | 0.014599   |   0.4 |  0.05
Modify  | 2.2158     | 2.2299     | 2.2399     |   0.5 |  8.15
Other   |            | 1.712      |            |       |  6.26

Nlocal:    640 ave 654 max 627 min
Histogram: 1 0 0 1 1 1 0 0 0 1
Nghost:    312.6 ave 321 max 302 min
Histogram: 1 1 0 0 0 0 0 1 0 2
Neighs:    4489.2 ave 4670 max 4347 min
Histogram: 1 1 0 0 1 0 1 0 0 1

Total # of neighbors = 22446
Ave neighs/atom = 7.01438
Neighbor list builds = 12769
Dangerous builds = 0
Total wall time: 0:00:29
